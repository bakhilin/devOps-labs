{"ast":null,"code":"var _jsxFileName = \"/home/nikita/Desktop/devOps-labs/lab5/react-frontend/src/components/root/users/business/Offer/UpdateOffer.jsx\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport OfferInputField from \"./fields/OfferInputField\";\nimport OfferTextaria from \"./fields/OfferTextaria\";\nimport Footer from \"../../../fragments/footer/Footer\";\nimport { useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport AuthenticationService from \"../../../../../api/authentication/AuthenticationService\";\nimport UpdateOfferDataService from \"../../../../../api/hobby/UpdateOfferDataService\";\nimport { useState, useEffect } from \"react\";\nimport styles from \"../../../../../css/CreateOffer.module.css\";\nimport style from \"../../../../../css/Footer.module.css\";\nimport { useLocation } from \"react-router-dom\";\nimport LoadingDots from \"./animation/LoadingDots\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst UpdateOffer = () => {\n  _s();\n\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [loading, setLoading] = useState(false);\n  const username = AuthenticationService.getLoggedInUser();\n  const [uploaded, setUploaded] = useState(false);\n  const [files, setFiles] = useState({});\n  const [info, setInfo] = useState({\n    id: location.state.id,\n    name: location.state.name,\n    slogan: location.state.slogan,\n    intro: location.state.intro,\n    description: location.state.description,\n    price: location.state.price,\n    creator: username,\n    contactInfo: location.state.contactInfo\n  });\n  const [errors, setErrors] = useState({});\n\n  const validate = () => {\n    const errors = {};\n\n    if (!files.profileImgUrl) {\n      errors.profileImgUrl = \"Profile photo is required\";\n    }\n\n    if (!info.name) {\n      errors.name = \"Hobby name is required\";\n    } else if (info.name.length < 3) {\n      errors.name = \"Hobby name must be at least 3 characters long\";\n    }\n\n    if (!info.slogan) {\n      errors.slogan = \"Slogan is required\";\n    } else if (info.slogan.length < 2 || info.slogan.length > 20) {\n      errors.slogan = \"Text has to be between 2 and 20 characters long\";\n    }\n\n    if (!info.category) {\n      errors.category = \"Category is required\";\n    }\n\n    if (!info.intro) {\n      errors.intro = \"Intro is required\";\n    } // else if (info.intro.length > 100 ) {\n    //     errors.intro = \"Text has to be at least 100 characters long\"\n    // }\n\n\n    if (!info.description) {\n      errors.description = \"Description is required\";\n    } // else if (info.description.length  > 200) {\n    //     errors.description = \"Text has to be at least 500 characters long\"\n    // }\n\n\n    if (!info.price) {\n      errors.price = \"Price is required\";\n    }\n\n    if (!info.location) {\n      errors.location = \"Location is required\";\n    }\n\n    if (!files.galleryImgUrl1) {\n      errors.galleryImgUrl1 = \"You must upload 3 high quality photos\";\n    }\n\n    if (!files.galleryImgUrl2) {\n      errors.galleryImgUrl2 = \"You must upload 3 high quality photos\";\n    }\n\n    if (!files.galleryImgUrl3) {\n      errors.galleryImgUrl3 = \"You must upload 3 high quality photos\";\n    }\n\n    if (!info.contactInfo) {\n      errors.contactInfo = \"Contact info is required\";\n    } // else if (info.contactInfo.length < 20 || info.contactInfo.length > 200) {\n    //     errors.contactInfo = \"Text has to be between 20 and 200 characters long\"\n    // }\n\n\n    return errors;\n  };\n\n  const submitHandler = event => {\n    event.preventDefault();\n    const public_ids = [];\n    const img_urls = [];\n    let fileURL = \"\";\n    let errors = validate(info);\n    setErrors(errors);\n\n    if (Object.keys(errors).length === 0) {\n      setLoading(true);\n      const filesToUpload = [files.profileImgUrl, files.galleryImgUrl1, files.galleryImgUrl2, files.galleryImgUrl3];\n      const uploaders = filesToUpload.map(async file => {\n        const formData = new FormData();\n        formData.append(\"file\", file);\n        formData.append(\"tags\", `dv6ktrxwv, hobbie`);\n        formData.append(\"upload_preset\", \"vgf01lnc\");\n        formData.append(\"timestamp\", Date.now() / 1000 | 0);\n        return await axios.post(\"https://api.cloudinary.com/v1_1/dv6ktrxwv/image/upload\", formData, {\n          headers: {\n            \"X-Requested-With\": \"XMLHttpRequest\"\n          }\n        }).then(_ref => {\n          let {\n            data\n          } = _ref;\n          fileURL = data.secure_url;\n          img_urls.push(fileURL);\n          public_ids.push(data.public_id);\n        });\n      }); // Once all the files are uploaded\n\n      axios.all(uploaders).then(() => {\n        setInfo(prevState => ({ ...prevState,\n          profileImgUrl: img_urls[0],\n          galleryImgUrl1: img_urls[1],\n          galleryImgUrl2: img_urls[2],\n          galleryImgUrl3: img_urls[3],\n          profileImg_id: public_ids[0],\n          galleryImg1_id: public_ids[1],\n          galleryImg2_id: public_ids[2],\n          galleryImg3_id: public_ids[3]\n        }));\n        setUploaded(true);\n      });\n    } else {\n      console.log(errors);\n    }\n  };\n\n  useEffect(() => {\n    const check_uploaded = () => {\n      if (uploaded) {\n        UpdateOfferDataService(info).then(res => {\n          if (res.data != null) {\n            window.location.href = \"/offer/\" + info.id;\n          }\n        }).catch(err => {\n          let error = \"\";\n          setLoading(false);\n\n          if (err.response) {\n            error += err.response;\n          }\n\n          return error;\n        });\n      }\n    };\n\n    check_uploaded();\n  }, [uploaded, info, navigate]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"main\", {\n      className: styles.offer_main,\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: styles.title_offer,\n        children: \"Edit offer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        className: styles.form_offer,\n        onSubmit: submitHandler,\n        children: [/*#__PURE__*/_jsxDEV(OfferInputField, {\n          defaultValue: location.state.name,\n          type: \"text\",\n          placeholder: \"ex: Painting, Swimming classes etc..\",\n          label: \"Hobbie Name\",\n          name: \"name\",\n          error: errors.name,\n          onChange: e => setInfo({ ...info,\n            name: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(OfferInputField, {\n          defaultValue: location.state.slogan,\n          type: \"text\",\n          placeholder: \"your offer in one sentence...\",\n          label: \"Slogan\",\n          name: \"slogan\",\n          error: errors.slogan,\n          onChange: e => setInfo({ ...info,\n            slogan: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.form_field_2,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Category\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            onChange: e => setInfo({ ...info,\n              category: e.target.value\n            }),\n            className: styles.custom_select,\n            id: \"category\",\n            name: \"category\",\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"Select category\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"ACTIVE\",\n              children: \"Active\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"SOCIAL\",\n              children: \"Social\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 213,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"FUN\",\n              children: \"Fun\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 214,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"RELAX\",\n              children: \"Relax\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"INTELLECTUAL\",\n              children: \"Intellectual\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 216,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"CREATIVE\",\n              children: \"Creative\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 217,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"OTHER\",\n              children: \"Other\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 218,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 13\n          }, this), errors.category && /*#__PURE__*/_jsxDEV(\"small\", {\n            className: styles.errors_offer,\n            children: errors.category\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(OfferTextaria, {\n          defaultValue: location.state.intro,\n          label: \"Intro\",\n          name: \"intro\",\n          error: errors.intro,\n          onChange: e => setInfo({ ...info,\n            intro: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(OfferTextaria, {\n          defaultValue: location.state.description,\n          label: \"Description\",\n          name: \"description\",\n          error: errors.description,\n          onChange: e => setInfo({ ...info,\n            description: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(OfferInputField, {\n          defaultValue: location.state.price,\n          type: \"number\",\n          placeholder: \"\",\n          label: \"Price per entry\",\n          name: \"price\",\n          error: errors.price,\n          onChange: e => setInfo({ ...info,\n            price: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.form_field_2,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Location\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 251,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            onChange: e => setInfo({ ...info,\n              location: e.target.value\n            }),\n            className: styles.custom_select,\n            id: \"location\",\n            name: \"location\",\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"Select location\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 258,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"ZURICH\",\n              children: \"Zurich\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"BERN\",\n              children: \"Bern\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"ZUG\",\n              children: \"Zug\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"LUZERN\",\n              children: \"Luzern\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 13\n          }, this), errors.location && /*#__PURE__*/_jsxDEV(\"small\", {\n            className: styles.errors_offer,\n            children: errors.location\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.form_field_photos,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.row_upload,\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              id: \"photo\",\n              className: styles.label_name,\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"\",\n                children: \"Gallery\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 272,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"article\", {\n              className: styles.button3,\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: styles.choose_file,\n                children: [\" \", files.profileImgUrl ? \"Photo uploaded\" : \"Choose a file\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 275,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                onChange: e => setFiles({ ...files,\n                  profileImgUrl: e.target.files[0]\n                }),\n                type: \"file\",\n                id: \"add-title-image\",\n                name: \"img\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 279,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"article\", {\n              className: styles.button3,\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: styles.choose_file,\n                children: [\" \", files.galleryImgUrl1 ? \"Photo uploaded\" : \"Choose a file\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 289,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                onChange: e => setFiles({ ...files,\n                  galleryImgUrl1: e.target.files[0]\n                }),\n                type: \"file\",\n                id: \"add-title-image\",\n                name: \"img\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 293,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 288,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"article\", {\n              className: styles.button3,\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: styles.choose_file,\n                children: [\" \", files.galleryImgUrl2 ? \"Photo uploaded\" : \"Choose a file\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 303,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                onChange: e => setFiles({ ...files,\n                  galleryImgUrl2: e.target.files[0]\n                }),\n                type: \"file\",\n                id: \"add-title-image\",\n                name: \"img\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 307,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 302,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"article\", {\n              className: styles.button3,\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: styles.choose_file,\n                children: [\" \", files.galleryImgUrl3 ? \"Photo uploaded\" : \"Choose a file\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 317,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                onChange: e => setFiles({ ...files,\n                  galleryImgUrl3: e.target.files[0]\n                }),\n                type: \"file\",\n                id: \"add-title-image\",\n                name: \"img\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 321,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 15\n            }, this), (errors.galleryImgUrl1 || errors.galleryImgUrl2 || errors.galleryImgUrl3 || errors.profileImgUrl) && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.errors_offer,\n              children: \"You must upload high quality photos\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 334,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(OfferTextaria, {\n          defaultValue: location.state.contactInfo,\n          label: \"Contact info\",\n          name: \"contact\",\n          error: errors.contact,\n          onChange: e => setInfo({ ...info,\n            contactInfo: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 11\n        }, this), loading && /*#__PURE__*/_jsxDEV(LoadingDots, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 23\n        }, this), !loading && /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: styles.submit_offer,\n          children: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {\n      class: style.footer_hobbie_details\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(UpdateOffer, \"zsJlIhmwLgM/FDPVesM8c7XlbeU=\", false, function () {\n  return [useNavigate, useLocation];\n});\n\n_c = UpdateOffer;\nexport default UpdateOffer;\n\nvar _c;\n\n$RefreshReg$(_c, \"UpdateOffer\");","map":{"version":3,"sources":["/home/nikita/Desktop/devOps-labs/lab5/react-frontend/src/components/root/users/business/Offer/UpdateOffer.jsx"],"names":["React","OfferInputField","OfferTextaria","Footer","useNavigate","axios","AuthenticationService","UpdateOfferDataService","useState","useEffect","styles","style","useLocation","LoadingDots","UpdateOffer","navigate","location","loading","setLoading","username","getLoggedInUser","uploaded","setUploaded","files","setFiles","info","setInfo","id","state","name","slogan","intro","description","price","creator","contactInfo","errors","setErrors","validate","profileImgUrl","length","category","galleryImgUrl1","galleryImgUrl2","galleryImgUrl3","submitHandler","event","preventDefault","public_ids","img_urls","fileURL","Object","keys","filesToUpload","uploaders","map","file","formData","FormData","append","Date","now","post","headers","then","data","secure_url","push","public_id","all","prevState","profileImg_id","galleryImg1_id","galleryImg2_id","galleryImg3_id","console","log","check_uploaded","res","window","href","catch","err","error","response","offer_main","title_offer","form_offer","e","target","value","form_field_2","custom_select","errors_offer","form_field_photos","row_upload","label_name","button3","choose_file","contact","submit_offer","footer_hobbie_details"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport OfferInputField from \"./fields/OfferInputField\";\nimport OfferTextaria from \"./fields/OfferTextaria\";\nimport Footer from \"../../../fragments/footer/Footer\";\nimport { useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport AuthenticationService from \"../../../../../api/authentication/AuthenticationService\";\nimport UpdateOfferDataService from \"../../../../../api/hobby/UpdateOfferDataService\";\nimport { useState, useEffect } from \"react\";\nimport styles from \"../../../../../css/CreateOffer.module.css\";\nimport style from \"../../../../../css/Footer.module.css\";\nimport { useLocation } from \"react-router-dom\";\nimport LoadingDots from \"./animation/LoadingDots\";\n\nconst UpdateOffer = () => {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [loading, setLoading] = useState(false);\n  const username = AuthenticationService.getLoggedInUser();\n  const [uploaded, setUploaded] = useState(false);\n\n  const [files, setFiles] = useState({});\n  const [info, setInfo] = useState({\n    id: location.state.id,\n    name: location.state.name,\n    slogan: location.state.slogan,\n    intro: location.state.intro,\n    description: location.state.description,\n    price: location.state.price,\n    creator: username,\n    contactInfo: location.state.contactInfo,\n  });\n\n  const [errors, setErrors] = useState({});\n\n  const validate = () => {\n    const errors = {};\n\n    if (!files.profileImgUrl) {\n      errors.profileImgUrl = \"Profile photo is required\";\n    }\n    if (!info.name) {\n      errors.name = \"Hobby name is required\";\n    } else if (info.name.length < 3) {\n      errors.name = \"Hobby name must be at least 3 characters long\";\n    }\n\n    if (!info.slogan) {\n      errors.slogan = \"Slogan is required\";\n    } else if (info.slogan.length < 2 || info.slogan.length > 20) {\n      errors.slogan = \"Text has to be between 2 and 20 characters long\";\n    }\n\n    if (!info.category) {\n      errors.category = \"Category is required\";\n    }\n\n    if (!info.intro) {\n      errors.intro = \"Intro is required\";\n    }\n    // else if (info.intro.length > 100 ) {\n    //     errors.intro = \"Text has to be at least 100 characters long\"\n    // }\n\n    if (!info.description) {\n      errors.description = \"Description is required\";\n    }\n    // else if (info.description.length  > 200) {\n    //     errors.description = \"Text has to be at least 500 characters long\"\n    // }\n\n    if (!info.price) {\n      errors.price = \"Price is required\";\n    }\n\n    if (!info.location) {\n      errors.location = \"Location is required\";\n    }\n    if (!files.galleryImgUrl1) {\n      errors.galleryImgUrl1 = \"You must upload 3 high quality photos\";\n    }\n    if (!files.galleryImgUrl2) {\n      errors.galleryImgUrl2 = \"You must upload 3 high quality photos\";\n    }\n    if (!files.galleryImgUrl3) {\n      errors.galleryImgUrl3 = \"You must upload 3 high quality photos\";\n    }\n\n    if (!info.contactInfo) {\n      errors.contactInfo = \"Contact info is required\";\n    }\n    // else if (info.contactInfo.length < 20 || info.contactInfo.length > 200) {\n    //     errors.contactInfo = \"Text has to be between 20 and 200 characters long\"\n    // }\n    return errors;\n  };\n\n  const submitHandler = (event) => {\n    event.preventDefault();\n\n    const public_ids = [];\n    const img_urls = [];\n    let fileURL = \"\";\n\n    let errors = validate(info);\n    setErrors(errors);\n    if (Object.keys(errors).length === 0) {\n      setLoading(true);\n      const filesToUpload = [\n        files.profileImgUrl,\n        files.galleryImgUrl1,\n        files.galleryImgUrl2,\n        files.galleryImgUrl3,\n      ];\n      const uploaders = filesToUpload.map(async (file) => {\n        const formData = new FormData();\n        formData.append(\"file\", file);\n        formData.append(\"tags\", `dv6ktrxwv, hobbie`);\n        formData.append(\"upload_preset\", \"vgf01lnc\");\n        formData.append(\"timestamp\", (Date.now() / 1000) | 0);\n\n        return await axios\n          .post(\n            \"https://api.cloudinary.com/v1_1/dv6ktrxwv/image/upload\",\n            formData,\n            {\n              headers: { \"X-Requested-With\": \"XMLHttpRequest\" },\n            }\n          )\n          .then(({ data }) => {\n            fileURL = data.secure_url;\n            img_urls.push(fileURL);\n            public_ids.push(data.public_id);\n          });\n      });\n\n      // Once all the files are uploaded\n      axios.all(uploaders).then(() => {\n        setInfo((prevState) => ({\n          ...prevState,\n          profileImgUrl: img_urls[0],\n          galleryImgUrl1: img_urls[1],\n          galleryImgUrl2: img_urls[2],\n          galleryImgUrl3: img_urls[3],\n          profileImg_id: public_ids[0],\n          galleryImg1_id: public_ids[1],\n          galleryImg2_id: public_ids[2],\n          galleryImg3_id: public_ids[3],\n        }));\n        setUploaded(true);\n      });\n    } else {\n      console.log(errors);\n    }\n  };\n\n  useEffect(() => {\n    const check_uploaded = () => {\n      if (uploaded) {\n        UpdateOfferDataService(info)\n          .then((res) => {\n            if (res.data != null) {\n              window.location.href = \"/offer/\" + info.id;\n            }\n          })\n          .catch((err) => {\n            let error = \"\";\n            setLoading(false);\n            if (err.response) {\n              error += err.response;\n            }\n            return error;\n          });\n      }\n    };\n    check_uploaded();\n  }, [uploaded, info, navigate]);\n\n  return (\n    <>\n      <main className={styles.offer_main}>\n        <h1 className={styles.title_offer}>Edit offer</h1>\n        <form className={styles.form_offer} onSubmit={submitHandler}>\n          <OfferInputField\n            defaultValue={location.state.name}\n            type=\"text\"\n            placeholder=\"ex: Painting, Swimming classes etc..\"\n            label=\"Hobbie Name\"\n            name=\"name\"\n            error={errors.name}\n            onChange={(e) => setInfo({ ...info, name: e.target.value })}\n          />\n          <OfferInputField\n            defaultValue={location.state.slogan}\n            type=\"text\"\n            placeholder=\"your offer in one sentence...\"\n            label=\"Slogan\"\n            name=\"slogan\"\n            error={errors.slogan}\n            onChange={(e) => setInfo({ ...info, slogan: e.target.value })}\n          />\n\n          <div className={styles.form_field_2}>\n            <span>Category</span>\n            <select\n              onChange={(e) => setInfo({ ...info, category: e.target.value })}\n              className={styles.custom_select}\n              id=\"category\"\n              name=\"category\"\n            >\n              <option value=\"\">Select category</option>\n              <option value=\"ACTIVE\">Active</option>\n              <option value=\"SOCIAL\">Social</option>\n              <option value=\"FUN\">Fun</option>\n              <option value=\"RELAX\">Relax</option>\n              <option value=\"INTELLECTUAL\">Intellectual</option>\n              <option value=\"CREATIVE\">Creative</option>\n              <option value=\"OTHER\">Other</option>\n            </select>\n            {errors.category && (\n              <small className={styles.errors_offer}>{errors.category}</small>\n            )}\n          </div>\n          <OfferTextaria\n            defaultValue={location.state.intro}\n            label=\"Intro\"\n            name=\"intro\"\n            error={errors.intro}\n            onChange={(e) => setInfo({ ...info, intro: e.target.value })}\n          />\n\n          <OfferTextaria\n            defaultValue={location.state.description}\n            label=\"Description\"\n            name=\"description\"\n            error={errors.description}\n            onChange={(e) => setInfo({ ...info, description: e.target.value })}\n          />\n\n          <OfferInputField\n            defaultValue={location.state.price}\n            type=\"number\"\n            placeholder=\"\"\n            label=\"Price per entry\"\n            name=\"price\"\n            error={errors.price}\n            onChange={(e) => setInfo({ ...info, price: e.target.value })}\n          />\n\n          <div className={styles.form_field_2}>\n            <span>Location</span>\n            <select\n              onChange={(e) => setInfo({ ...info, location: e.target.value })}\n              className={styles.custom_select}\n              id=\"location\"\n              name=\"location\"\n            >\n              <option value=\"\">Select location</option>\n              <option value=\"ZURICH\">Zurich</option>\n              <option value=\"BERN\">Bern</option>\n              <option value=\"ZUG\">Zug</option>\n              <option value=\"LUZERN\">Luzern</option>\n            </select>\n            {errors.location && (\n              <small className={styles.errors_offer}>{errors.location}</small>\n            )}\n          </div>\n\n          <div className={styles.form_field_photos}>\n            <div className={styles.row_upload}>\n              <label id=\"photo\" className={styles.label_name}>\n                <span className=\"\">Gallery</span>\n              </label>\n              <article className={styles.button3}>\n                <p className={styles.choose_file}>\n                  {\" \"}\n                  {files.profileImgUrl ? \"Photo uploaded\" : \"Choose a file\"}\n                </p>\n                <input\n                  onChange={(e) =>\n                    setFiles({ ...files, profileImgUrl: e.target.files[0] })\n                  }\n                  type=\"file\"\n                  id=\"add-title-image\"\n                  name=\"img\"\n                />\n              </article>\n              <article className={styles.button3}>\n                <p className={styles.choose_file}>\n                  {\" \"}\n                  {files.galleryImgUrl1 ? \"Photo uploaded\" : \"Choose a file\"}\n                </p>\n                <input\n                  onChange={(e) =>\n                    setFiles({ ...files, galleryImgUrl1: e.target.files[0] })\n                  }\n                  type=\"file\"\n                  id=\"add-title-image\"\n                  name=\"img\"\n                />\n              </article>\n              <article className={styles.button3}>\n                <p className={styles.choose_file}>\n                  {\" \"}\n                  {files.galleryImgUrl2 ? \"Photo uploaded\" : \"Choose a file\"}\n                </p>\n                <input\n                  onChange={(e) =>\n                    setFiles({ ...files, galleryImgUrl2: e.target.files[0] })\n                  }\n                  type=\"file\"\n                  id=\"add-title-image\"\n                  name=\"img\"\n                />\n              </article>\n              <article className={styles.button3}>\n                <p className={styles.choose_file}>\n                  {\" \"}\n                  {files.galleryImgUrl3 ? \"Photo uploaded\" : \"Choose a file\"}\n                </p>\n                <input\n                  onChange={(e) =>\n                    setFiles({ ...files, galleryImgUrl3: e.target.files[0] })\n                  }\n                  type=\"file\"\n                  id=\"add-title-image\"\n                  name=\"img\"\n                />\n              </article>\n              {(errors.galleryImgUrl1 ||\n                errors.galleryImgUrl2 ||\n                errors.galleryImgUrl3 ||\n                errors.profileImgUrl) && (\n                <div className={styles.errors_offer}>\n                  You must upload high quality photos\n                </div>\n              )}\n            </div>\n          </div>\n          <OfferTextaria\n            defaultValue={location.state.contactInfo}\n            label=\"Contact info\"\n            name=\"contact\"\n            error={errors.contact}\n            onChange={(e) => setInfo({ ...info, contactInfo: e.target.value })}\n          />\n\n          {loading && <LoadingDots />}\n\n          {!loading && (\n            <button type=\"submit\" className={styles.submit_offer}>\n              Submit\n            </button>\n          )}\n        </form>\n      </main>\n\n      <Footer class={style.footer_hobbie_details} />\n    </>\n  );\n};\n\nexport default UpdateOffer;\n"]},"metadata":{},"sourceType":"module"}